-- 1️⃣ 新增欄位
ALTER TABLE MY_TABLE ADD (IDX_NUMBER NUMBER);

-- 2️⃣ 建立序列
CREATE SEQUENCE MY_TABLE_SEQ START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE;

-- 3️⃣ 先補上現有資料的流水號
UPDATE MY_TABLE SET IDX_NUMBER = MY_TABLE_SEQ.NEXTVAL;

-- 4️⃣ 建立觸發器（以後自動編號）
CREATE OR REPLACE TRIGGER MY_TABLE_BI
BEFORE INSERT ON MY_TABLE
FOR EACH ROW
BEGIN
  IF :NEW.IDX_NUMBER IS NULL THEN
    :NEW.IDX_NUMBER := MY_TABLE_SEQ.NEXTVAL;
  END IF;
END;
/
