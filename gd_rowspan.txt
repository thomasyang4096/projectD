Protected Sub GridView1_PreRender(sender As Object, e As EventArgs) Handles GridView1.PreRender
    Dim colIndex As Integer = 0 '要合併的欄位
    Dim rowCount As Integer = GridView1.Rows.Count

    For i As Integer = rowCount - 2 To 0 Step -1
        Dim curr As GridViewRow = GridView1.Rows(i)
        Dim nextRow As GridViewRow = GridView1.Rows(i + 1)

        ' 使用 DataKey 判斷
        Dim currKey As Object = GridView1.DataKeys(i).Value
        Dim nextKey As Object = GridView1.DataKeys(i + 1).Value

        If currKey = nextKey Then
            ' 合併儲存格
            If nextRow.Cells(colIndex).RowSpan < 2 Then
                curr.Cells(colIndex).RowSpan = 2
            Else
                curr.Cells(colIndex).RowSpan = nextRow.Cells(colIndex).RowSpan + 1
            End If

            nextRow.Cells(colIndex).Visible = False
        End If
    Next
End Sub
