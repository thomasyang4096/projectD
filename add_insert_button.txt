<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" DataKeyNames="idx" OnRowCommand="GridView1_RowCommand">
    <Columns>
        <asp:BoundField DataField="Name" HeaderText="Name" />
        <asp:BoundField DataField="Value" HeaderText="Value" />
        
        <asp:TemplateField HeaderText="Action">
            <ItemTemplate>
                <asp:LinkButton ID="btnEdit" runat="server"
                    CommandName="Edit" Text="Edit" />
                <asp:LinkButton ID="btnAdd" runat="server"
                    CommandName="AddItem" Text="Add" />
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView>

Protected Sub GridView1_RowDataBound(sender As Object, e As GridViewRowEventArgs) _
    Handles GridView1.RowDataBound

    If e.Row.RowType = DataControlRowType.DataRow Then

        Dim currKey = GridView1.DataKeys(e.Row.RowIndex).Value
        Dim btnAdd As Button = CType(e.Row.FindControl("btnAdd"), Button)

        If e.Row.RowIndex = 0 Then
            btnAdd.Visible = True
            Exit Sub
        End If

        Dim prevKey = GridView1.DataKeys(e.Row.RowIndex - 1).Value

        btnAdd.Visible = (currKey <> prevKey)

    End If
End Sub

<asp:LinkButton ID="btnAdd" runat="server"
    CommandName="AddItem"
    CommandArgument='<%# Container.DataItemIndex %>'
    Text="Add" />

Protected Sub GridView1_RowCommand(sender As Object, e As GridViewCommandEventArgs) _
    Handles GridView1.RowCommand
 ' 測試：先印出 CommandName
    Response.Write("RowCommand triggered: " & e.CommandName & "<br>")
    If e.CommandName = "AddItem" Then

        ' 取得按下按鈕的 rowIndex
        Dim rowIndex As Integer = Convert.ToInt32(e.CommandArgument)
        ' 取得該列的 idx (DataKey)
        Dim targetIdx = GridView1.DataKeys(rowIndex).Value

        ' 記錄 InsertMode 與目標 idx
        ViewState("InsertMode") = True
        ViewState("InsertTargetIdx") = targetIdx

        BindGrid()

    End If

End Sub

Private Sub BindGrid()

    Dim dt As DataTable = GetData()

    If ViewState("InsertMode") IsNot Nothing AndAlso ViewState("InsertMode") Then
        Dim newRow As DataRow = dt.NewRow()
        newRow("idx") = ViewState("InsertTargetIdx") ' 同組 idx

    ' ⭐ 這裡複製欄位資料（重要）
    newRow("col1") = dt.Rows(insertIndex)("col1")
    newRow("col2") = dt.Rows(insertIndex)("col2")
     '   dt.Rows.InsertAt(newRow, 0)  ' 插入在最前面
    ' 插入新 row 在群組第一筆之前
    dt.Rows.InsertAt(newRow, insertIndex)


    GridView1.DataSource = dt
    GridView1.DataBind()

End Sub

Private Sub BindGrid()

    Dim dt As DataTable = GetData()

    ' Insert Mode → 在符合 DataKey 群組插入空白 row
    If ViewState("InsertMode") IsNot Nothing AndAlso ViewState("InsertMode") Then

        Dim newRow As DataRow = dt.NewRow()
        newRow("DataKey") = ViewState("InsertTargetKey") ' 你要決定加在哪組
        ' 其他欄位預設空白
        dt.Rows.InsertAt(newRow, 0)

    End If

    GridView1.DataSource = dt
    GridView1.DataBind()

End Sub

Protected Sub GridView1_RowUpdating(sender As Object, e As GridViewUpdateEventArgs) Handles GridView1.RowUpdating

    ' 讀入 TextBox 等控制項值，寫入資料庫
    ' ...

    ViewState("InsertMode") = Nothing   ' 回到一般模式
    GridView1.EditIndex = -1

    BindGrid()

End Sub

Protected Sub GridView1_PreRender(sender As Object, e As EventArgs) Handles Me.PreRender
    If ViewState("InsertMode") = True Then
        GridView1.EditIndex = 0
    End If

    ' 你的 MergeCells() 也放在這裡
    MergeCells()
End Sub
