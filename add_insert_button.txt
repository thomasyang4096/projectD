<asp:TemplateField HeaderText="Action">
    <ItemTemplate>
        <asp:Button ID="btnEdit" runat="server" Text="Edit" CommandName="Edit" />
        <asp:Button ID="btnAdd"  runat="server" Text="Add" CommandName="AddItem" />
    </ItemTemplate>
</asp:TemplateField>

Protected Sub GridView1_RowDataBound(sender As Object, e As GridViewRowEventArgs) _
    Handles GridView1.RowDataBound

    If e.Row.RowType = DataControlRowType.DataRow Then

        Dim currKey = GridView1.DataKeys(e.Row.RowIndex).Value
        Dim btnAdd As Button = CType(e.Row.FindControl("btnAdd"), Button)

        If e.Row.RowIndex = 0 Then
            btnAdd.Visible = True
            Exit Sub
        End If

        Dim prevKey = GridView1.DataKeys(e.Row.RowIndex - 1).Value

        btnAdd.Visible = (currKey <> prevKey)

    End If
End Sub

Protected Sub GridView1_RowCommand(sender As Object, e As GridViewCommandEventArgs) Handles GridView1.RowCommand

    If e.CommandName = "AddItem" Then
        ViewState("InsertMode") = True
        BindGrid()
    End If

End Sub

Private Sub BindGrid()

    Dim dt As DataTable = GetData()

    If ViewState("InsertMode") = True Then
        Dim newRow As DataRow = dt.NewRow()
        newRow("DataKeyColumn") = DBNull.Value
        newRow("Name") = ""
        newRow("Value") = ""
        dt.Rows.InsertAt(newRow, 0)   ' 插在最前面
    End If

    GridView1.DataSource = dt
    GridView1.DataBind()

End Sub

Private Sub BindGrid()

    Dim dt As DataTable = GetData()

    ' Insert Mode → 在符合 DataKey 群組插入空白 row
    If ViewState("InsertMode") IsNot Nothing AndAlso ViewState("InsertMode") Then

        Dim newRow As DataRow = dt.NewRow()
        newRow("DataKey") = ViewState("InsertTargetKey") ' 你要決定加在哪組
        ' 其他欄位預設空白
        dt.Rows.InsertAt(newRow, 0)

    End If

    GridView1.DataSource = dt
    GridView1.DataBind()

End Sub

Protected Sub GridView1_RowUpdating(sender As Object, e As GridViewUpdateEventArgs) Handles GridView1.RowUpdating

    ' 讀入 TextBox 等控制項值，寫入資料庫
    ' ...

    ViewState("InsertMode") = Nothing   ' 回到一般模式
    GridView1.EditIndex = -1

    BindGrid()

End Sub
